{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap bfc125e808897955d015","webpack:///../dzhyun-connection/lib/BaseConnection.js","webpack:///../dzhyun-dataparser/lib/util.js","webpack:///../dzhyun-connection/lib/index.js","webpack:///../dzhyun-dataparser/lib/DzhyunDataParser.js","webpack:///./src/util.js","webpack:///../dzhyun-dataparser/~/snappyjs/snappy_decompressor.js","webpack:///../dzhyun-connection/lib/HttpConnection.js","webpack:///../dzhyun-connection/lib/WebSocket.js","webpack:///../dzhyun-connection/lib/WebSocketConnection.js","webpack:///../dzhyun-connection/lib/XMLHttpRequest.js","webpack:///../dzhyun-connection/lib/ajax.js","webpack:///../dzhyun-connection/lib/util.js","webpack:///../dzhyun-connection/src/util.js","webpack:///../dzhyun-dataparser/lib/parseJSON.js","webpack:///../dzhyun-dataparser/lib/snappyjs-uncompress.js","webpack:///../dzhyun-dataparser/lib/parseProtoBuf.js","webpack:///./src/Dzhyun.js","webpack:///ws (ignored)","webpack:///xhr2 (ignored)"],"names":["Object","defineProperty","exports","value","_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","undefined","_i","Symbol","iterator","_s","next","done","push","length","err","Array","isArray","TypeError","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_classCallCheck","instance","BaseConnection","address","options","handler","secure","Error","constructor","getInstance","_address","_secure","_handler","_protocol","_listenerMap","getAddress","getProtocol","replace","request","message","send","close","on","type","listener","listeners","indexOf","off","index","splice","trigger","_this","_len","arguments","args","_key","forEach","apply","EVENT_OPEN","EVENT_CLOSE","EVENT_ERROR","EVENT_REQUEST","EVENT_SEND","EVENT_RESPONSE","EVENT_MESSAGE","EVENT_PROGRESS","url","_$exec","exec","_$exec2","_$exec2$","protocol","urlWithoutProtocol","func","default","stringToArrayBuffer","arrayBufferToString","_toConsumableArray","arr2","from","str","strLen","buf","ArrayBuffer","bufView","Uint8Array","charCodeAt","arrayBuffer","uint8Array","results","start","subArray","subarray","String","fromCharCode","decodeURIComponent","escape","join","_BaseConnection","require","_BaseConnection2","_interopRequireDefault","obj","__esModule","module","_snappyjsUncompress","_snappyjsUncompress2","_parseProtoBuf2","_parseProtoBuf3","_parseJSON2","_parseJSON3","_util","DzhyunDataParser","parse","input","Promise","resolve","then","compresser","uncompress","data","isJSON","parseJSON","parseProtoBuf","yfloat","catch","e","bind","parseYfloat","reject","first","result","unParam","searchStr","substring","split","reduce","pair","slice","_BaseConnection3","_ajax","_ajax2","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","HttpConnection","_ref","getPrototypeOf","concat","_request","_this2","ajaxOptions","assign","xhr","success","error","jqXHR","textStatus","errorThrown","complete","onreadystatechange","origFun","readyState","onprogress","event","_this3","abort","http","https","_ws","_ws2","window","WebSocket","console","warn","_WebSocket","_WebSocket2","WebSocketConnection","deferred","_connect","getStatus","CLOSED","OPEN","CONNECTING","CLOSING","binaryType","dataType","addEventListener","msg","ws","wss","_xhr","_xhr2","XMLHttpRequest","_typeof","_XMLHttpRequest","_XMLHttpRequest2","getArrayBufferResponse","response","text","responseText","getBlobResponse","Blob","jsonpID","nodejs","document","name","rscript","scriptTypeRE","xmlTypeRE","jsonType","htmlType","blankRE","ajax","settings","crossDomain","test","location","RegExp","$2","host","hasPlaceholder","appendQuery","JSONP","toString","serializeData","mime","accepts","baseHeaders","$1","abortTimeout","XDomainRequest","onload","status","overrideMimeType","contentType","toUpperCase","headers","clearTimeout","mimeToDataType","getResponseHeader","eval","responseXML","JSON","ajaxError","ajaxSuccess","async","open","supported","responseType","setRequestHeader","ajaxBeforeSend","timeout","setTimeout","empty","triggerAndReturn","context","eventName","triggerGlobal","global","active","ajaxStart","ajaxStop","beforeSend","ajaxComplete","callbackName","script","createElement","head","getElementsByTagName","documentElement","onerror","src","insertBefore","firstChild","json","xml","html","query","param","get","post","getJSON","serialize","params","traditional","scope","array","keys","add","k","v","encodeURIComponent","_defineProperty","convertToJsonArray","map","row","rowObject","cell","columnIndex","Err","Data","JsonTbl","tbl","Id","Qid","Counter","_snappy_decompressor","compressed","decompressor","SnappyDecompressor","readUncompressedLength","uncompressed","uncompressedView","uncompressToBuffer","formatParams","lastQid","getQid","EventEmiter","Request","subscribe","queryObject","sub","alias","onmessage","callback","Dzhyun","dataParser","token","generateQid","_requests","_conn","tokenPromise","getToken","connection","desc","code","resultData","shrinkData","filter","sort","key1","connectionType","_token","_connectionType","serviceUrl","output","qid","cancel","_connection","conn","requestParams","_cancelRequest","requests","eachQid","Connection","DataParser"],"mappings":"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","file":"dzhyun-json.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Dzhyun\"] = factory();\n\telse\n\t\troot[\"Dzhyun\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 16);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap bfc125e808897955d015","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\n * connection基类\n */\nvar BaseConnection = function () {\n\n  /**\n   * 构造方法\n   * @param {!string} address 连接地址\n   * @param {!object} options 设置参数\n   * @param {object=} handler 事件处理对象\n   * @param {boolean=} [secure=false]\n   */\n  function BaseConnection(address, options, handler, secure) {\n    _classCallCheck(this, BaseConnection);\n\n    if (typeof address !== 'string') {\n      throw new Error('address is incorrect');\n    }\n    if (this.constructor === BaseConnection) {\n      // eslint-disable-next-line no-use-before-define\n      return getInstance(address, options, handler);\n    }\n    this._address = address;\n    this.options = options || {};\n\n    if (typeof handler === 'boolean') {\n      this._secure = handler;\n      this._handler = null;\n    } else {\n      this._secure = secure || false;\n      this._handler = handler;\n    }\n\n    // 默认协议\n    this._protocol = 'http';\n\n    this._listenerMap = {};\n  }\n\n  _createClass(BaseConnection, [{\n    key: 'getAddress',\n    value: function getAddress() {\n      return this.getProtocol() + '://' + this._address.replace(/^(\\w+:\\/\\/)?/, '');\n    }\n  }, {\n    key: 'getProtocol',\n    value: function getProtocol() {\n      return this._protocol + (this._secure ? 's' : '');\n    }\n\n    // eslint-disable-next-line no-unused-vars,class-methods-use-this\n\n  }, {\n    key: 'request',\n    value: function request(message, options) {}\n  }, {\n    key: 'send',\n    value: function send(message, options) {\n      return this.request(message, options);\n    }\n\n    // eslint-disable-next-line class-methods-use-this\n\n  }, {\n    key: 'close',\n    value: function close() {}\n\n    /**\n     * 事件监听接口\n     */\n\n  }, {\n    key: 'on',\n    value: function on(type, listener) {\n      if (typeof listener === 'function') {\n        var listeners = this._listenerMap[type] || (this._listenerMap[type] = []);\n        if (listeners.indexOf(listener) < 0) {\n          listeners.push(listener);\n        }\n      }\n      return this;\n    }\n  }, {\n    key: 'off',\n    value: function off(type, listener) {\n      if (typeof listener === 'function') {\n        var listeners = this._listenerMap[type] || (this._listenerMap[type] = []);\n        var index = listeners.indexOf(listener);\n        if (index >= 0) listeners.splice(index, 1);\n      }\n      return this;\n    }\n  }, {\n    key: 'trigger',\n    value: function trigger(type) {\n      var _this = this,\n          _handler;\n\n      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      var listeners = this._listenerMap[type];\n      if (listeners) listeners.forEach(function (listener) {\n        return listener.apply(_this, args);\n      });\n\n      // 同时触发handler中对应方法\n      if (this._handler && typeof this._handler[type] === 'function') (_handler = this._handler)[type].apply(_handler, args);\n      return this;\n    }\n  }]);\n\n  return BaseConnection;\n}();\n\nBaseConnection.EVENT_OPEN = 'open';\nBaseConnection.EVENT_CLOSE = 'close';\nBaseConnection.EVENT_ERROR = 'error';\nBaseConnection.EVENT_REQUEST = 'request';\nBaseConnection.EVENT_SEND = 'send';\nBaseConnection.EVENT_RESPONSE = 'response';\nBaseConnection.EVENT_MESSAGE = 'message';\nBaseConnection.EVENT_PROGRESS = 'progress';\n\nfunction getInstance(url, options, handler) {\n  var _$exec = /^((\\w+):\\/\\/)?(.*)/.exec(url),\n      _$exec2 = _slicedToArray(_$exec, 4),\n      _$exec2$ = _$exec2[2],\n      protocol = _$exec2$ === undefined ? 'http' : _$exec2$,\n      urlWithoutProtocol = _$exec2[3];\n\n  var func = BaseConnection[protocol];\n  if (!func) {\n    throw new Error('protocol \"' + protocol + '\" no support');\n  }\n  return func(urlWithoutProtocol, options, handler);\n}\n\nexports.default = BaseConnection;\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-connection/lib/BaseConnection.js","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.stringToArrayBuffer = stringToArrayBuffer;\nexports.arrayBufferToString = arrayBufferToString;\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction stringToArrayBuffer(str) {\n  var strLen = str.length;\n  var buf = new ArrayBuffer(strLen * 2); // 2 bytes for each char\n  var bufView = new Uint8Array(buf);\n  for (var i = 0; i < strLen; i += 1) {\n    bufView[i] = str.charCodeAt(i);\n  }\n  return buf;\n}\n\nfunction arrayBufferToString(arrayBuffer) {\n  var uint8Array = new Uint8Array(arrayBuffer);\n  var length = uint8Array.length;\n  if (length > 65535) {\n    var results = [];\n    var start = 0;\n    do {\n      var subArray = uint8Array.subarray(start, start += 65535);\n      results.push(String.fromCharCode.apply(String, _toConsumableArray(subArray)));\n    } while (start < length);\n\n    return decodeURIComponent(escape(results.join('')));\n  }\n  return decodeURIComponent(escape(String.fromCharCode.apply(String, _toConsumableArray(uint8Array))));\n}\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-dataparser/lib/util.js","'use strict';\n\nvar _BaseConnection = require('./BaseConnection');\n\nvar _BaseConnection2 = _interopRequireDefault(_BaseConnection);\n\nrequire('./HttpConnection');\n\nrequire('./WebSocketConnection');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nmodule.exports = _BaseConnection2.default;\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-connection/lib/index.js","'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _snappyjsUncompress = require('./snappyjs-uncompress');\n\nvar _snappyjsUncompress2 = _interopRequireDefault(_snappyjsUncompress);\n\nvar _parseProtoBuf2 = require('./parseProtoBuf');\n\nvar _parseProtoBuf3 = _interopRequireDefault(_parseProtoBuf2);\n\nvar _parseJSON2 = require('./parseJSON');\n\nvar _parseJSON3 = _interopRequireDefault(_parseJSON2);\n\nvar _util = require('./util');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DzhyunDataParser = function () {\n\n  // options.compresser 压缩格式，默认不设置则根据数据自动判断，先直接解析数据失败了再解压后再次解析，\n  // 'snappy'使用snappy压缩，解压时如果失败直接报错，false不使用压缩，直接解析数据失败直接报错\n  // options.yfloat {bool} 是否将long类型数据做yfloat解析，默认不设置为true，设置为false则不解析, 不包括pbtable\n  function DzhyunDataParser() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, DzhyunDataParser);\n\n    this.options = options;\n  }\n\n  _createClass(DzhyunDataParser, [{\n    key: 'parse',\n    value: function parse(input) {\n      var _this = this;\n\n      return Promise.resolve().then(function () {\n        return _this.options.compresser === 'snappy' ? DzhyunDataParser.uncompress(input) : input;\n      }).then(function (data) {\n        if (DzhyunDataParser.isJSON(data)) {\n          return DzhyunDataParser.parseJSON(data);\n        } else if (_this.options.compresser === undefined) {\n          // 默认自动判断压缩时，当解析pb失败后再次解压后再尝试解析\n          return DzhyunDataParser.parseProtoBuf(data, _this.options.yfloat !== false).catch(function (e) {\n            return DzhyunDataParser.uncompress(data).catch(function () {\n              throw e;\n            }).then(_this.parse.bind(_this));\n          });\n        }\n        return DzhyunDataParser.parseProtoBuf(data, _this.options.yfloat !== false);\n      });\n    }\n  }], [{\n    key: 'parseProtoBuf',\n    value: function parseProtoBuf(data, parseYfloat) {\n      return typeof _parseProtoBuf3.default === 'function' ? (0, _parseProtoBuf3.default)(data, parseYfloat) : Promise.reject(new Error('no support parse protobuf data'));\n    }\n  }, {\n    key: 'parseJSON',\n    value: function parseJSON(data) {\n      return typeof _parseJSON3.default === 'function' ? (0, _parseJSON3.default)(data) : Promise.reject(new Error('no support parse JSON data'));\n    }\n  }, {\n    key: 'isJSON',\n    value: function isJSON(data) {\n      var first = void 0;\n      if (typeof data === 'string') {\n        first = data.charCodeAt(0);\n      } else if (data instanceof ArrayBuffer) {\n        first = new Uint8Array(data)[0];\n      }\n      return first === 123;\n    }\n  }, {\n    key: 'uncompress',\n    value: function uncompress(data) {\n      return Promise.resolve().then(function () {\n        var result = data;\n        if (typeof _snappyjsUncompress2.default !== 'function') throw new Error('no support snappy uncompress');\n        if (typeof data === 'string') {\n          result = (0, _util.stringToArrayBuffer)(result);\n          result = (0, _snappyjsUncompress2.default)(result);\n        } else {\n          result = (0, _snappyjsUncompress2.default)(result);\n        }\n        return result;\n      });\n    }\n  }]);\n\n  return DzhyunDataParser;\n}();\n\nmodule.exports = DzhyunDataParser;\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-dataparser/lib/DzhyunDataParser.js","export * from 'dzhyun-connection/src/util';\n\nexport function unParam(searchStr) {\n  return (searchStr.indexOf('?') === 0 ? searchStr.substring(1) : searchStr).split('&').reduce((result, pair) => {\n    if (pair !== '') {\n      const arr = pair.split('=');\n      result[decodeURIComponent(arr[0])] = decodeURIComponent(arr.slice(1).join('=')); // eslint-disable-line\n    }\n    return result;\n  }, {});\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util.js","// The MIT License (MIT)\n//\n// Copyright (c) 2016 Zhipeng Jia\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in all\n// copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n// SOFTWARE.\n\n'use strict'\n\nvar WORD_MASK = [0, 0xff, 0xffff, 0xffffff, 0xffffffff]\n\nfunction copyBytes (from_array, from_pos, to_array, to_pos, length) {\n  var i\n  for (i = 0; i < length; i++) {\n    to_array[to_pos + i] = from_array[from_pos + i]\n  }\n}\n\nfunction selfCopyBytes (array, pos, offset, length) {\n  var i\n  for (i = 0; i < length; i++) {\n    array[pos + i] = array[pos - offset + i]\n  }\n}\n\nfunction SnappyDecompressor (compressed) {\n  this.array = compressed\n  this.pos = 0\n}\n\nSnappyDecompressor.prototype.readUncompressedLength = function () {\n  var result = 0\n  var shift = 0\n  var c, val\n  while (shift < 32 && this.pos < this.array.length) {\n    c = this.array[this.pos]\n    this.pos += 1\n    val = c & 0x7f\n    if (((val << shift) >>> shift) !== val) {\n      return -1\n    }\n    result |= val << shift\n    if (c < 128) {\n      return result\n    }\n    shift += 7\n  }\n  return -1\n}\n\nSnappyDecompressor.prototype.uncompressToBuffer = function (out_buffer) {\n  var array = this.array\n  var array_length = array.length\n  var pos = this.pos\n  var out_pos = 0\n\n  var c, len, small_len\n  var offset\n\n  while (pos < array.length) {\n    c = array[pos]\n    pos += 1\n    if ((c & 0x3) === 0) {\n      // Literal\n      len = (c >>> 2) + 1\n      if (len > 60) {\n        if (pos + 3 >= array_length) {\n          return false\n        }\n        small_len = len - 60\n        len = array[pos] + (array[pos + 1] << 8) + (array[pos + 2] << 16) + (array[pos + 3] << 24)\n        len = (len & WORD_MASK[small_len]) + 1\n        pos += small_len\n      }\n      if (pos + len > array_length) {\n        return false\n      }\n      copyBytes(array, pos, out_buffer, out_pos, len)\n      pos += len\n      out_pos += len\n    } else {\n      switch (c & 0x3) {\n        case 1:\n          len = ((c >>> 2) & 0x7) + 4\n          offset = array[pos] + ((c >>> 5) << 8)\n          pos += 1\n          break\n        case 2:\n          if (pos + 1 >= array_length) {\n            return false\n          }\n          len = (c >>> 2) + 1\n          offset = array[pos] + (array[pos + 1] << 8)\n          pos += 2\n          break\n        case 3:\n          if (pos + 3 >= array_length) {\n            return false\n          }\n          len = (c >>> 2) + 1\n          offset = array[pos] + (array[pos + 1] << 8) + (array[pos + 2] << 16) + (array[pos + 3] << 24)\n          pos += 4\n          break\n        default:\n          break\n      }\n      if (offset === 0 || offset > out_pos) {\n        return false\n      }\n      selfCopyBytes(out_buffer, out_pos, offset, len)\n      out_pos += len\n    }\n  }\n  return true\n}\n\nexports.SnappyDecompressor = SnappyDecompressor\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../dzhyun-dataparser/~/snappyjs/snappy_decompressor.js\n// module id = 5\n// module chunks = 0 1","'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseConnection2 = require('./BaseConnection');\n\nvar _BaseConnection3 = _interopRequireDefault(_BaseConnection2);\n\nvar _ajax = require('./ajax');\n\nvar _ajax2 = _interopRequireDefault(_ajax);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar HttpConnection = function (_BaseConnection) {\n  _inherits(HttpConnection, _BaseConnection);\n\n  function HttpConnection() {\n    var _ref;\n\n    _classCallCheck(this, HttpConnection);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    // 用于记录当前未关闭的请求\n    var _this = _possibleConstructorReturn(this, (_ref = HttpConnection.__proto__ || Object.getPrototypeOf(HttpConnection)).call.apply(_ref, [this].concat(args)));\n\n    _this._request = [];\n    return _this;\n  }\n\n  _createClass(HttpConnection, [{\n    key: 'request',\n    value: function request(message, options) {\n      var _this2 = this;\n\n      var ajaxOptions = Object.assign({}, this.options, options);\n      var xhr = void 0;\n\n      ajaxOptions.success = function (data) {\n        _this2.trigger(_BaseConnection3.default.EVENT_MESSAGE, data);\n        _this2.trigger(_BaseConnection3.default.EVENT_RESPONSE, data);\n      };\n\n      ajaxOptions.error = function (jqXHR, textStatus, errorThrown) {\n        _this2.trigger(_BaseConnection3.default.EVENT_ERROR, errorThrown);\n      };\n\n      ajaxOptions.complete = function () {\n        var index = _this2._request.indexOf(xhr);\n        _this2._request.splice(index, 1);\n      };\n\n      ajaxOptions.url = this.getAddress() + (message || '');\n\n      xhr = (0, _ajax2.default)(ajaxOptions);\n\n      if (xhr) {\n        xhr.onreadystatechange = function (origFun) {\n          return function () {\n            if (xhr.readyState === 2) {\n\n              // 发出了请求\n              _this2.trigger(_BaseConnection3.default.EVENT_SEND, message);\n              _this2.trigger(_BaseConnection3.default.EVENT_REQUEST, message);\n            }\n            if (origFun) origFun();\n          };\n        }(xhr.onreadystatechange);\n      }\n\n      // 打开了连接\n      this.trigger(_BaseConnection3.default.EVENT_OPEN);\n\n      this._request.push(xhr);\n\n      xhr.onprogress = function (event) {\n        _this2.trigger(_BaseConnection3.default.EVENT_PROGRESS, event);\n      };\n\n      return this;\n    }\n  }, {\n    key: 'close',\n    value: function close() {\n      var _this3 = this;\n\n      // 取消全部未结束的请求\n      this._request.forEach(function (xhr, index) {\n        xhr.abort();\n        _this3._request.splice(index, 1);\n      });\n\n      this.trigger(_BaseConnection3.default.EVENT_CLOSE);\n      return this;\n    }\n  }]);\n\n  return HttpConnection;\n}(_BaseConnection3.default);\n\n_BaseConnection3.default.http = function http(url, options, handler) {\n  return new HttpConnection(url, options, handler, false);\n};\n\n_BaseConnection3.default.https = function https(url, options, handler) {\n  return new HttpConnection(url, options, handler, true);\n};\n\nmodule.exports = _BaseConnection3.default;\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-connection/lib/HttpConnection.js","'use strict';\n\nvar _ws = require('ws');\n\nvar _ws2 = _interopRequireDefault(_ws);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// WebSocket依赖，node环境使用模块ws\nif (typeof window !== 'undefined') {\n  if (window.WebSocket) {\n    module.exports = window.WebSocket;\n  } else {\n    console.warn('当前浏览器不支持WebSocket');\n  }\n} else if (typeof WebSocket !== 'undefined') {\n  // eslint-disable-next-line no-undef\n  module.exports = WebSocket;\n} else {\n  module.exports = _ws2.default;\n}\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-connection/lib/WebSocket.js","'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _BaseConnection2 = require('./BaseConnection');\n\nvar _BaseConnection3 = _interopRequireDefault(_BaseConnection2);\n\nvar _WebSocket = require('./WebSocket');\n\nvar _WebSocket2 = _interopRequireDefault(_WebSocket);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar WebSocketConnection = function (_BaseConnection) {\n  _inherits(WebSocketConnection, _BaseConnection);\n\n  /**\n   * @param address\n   * @param {{deferred: boolean}} options\n   *  deferred: false 创建连接时马上连接websocket，默认\n   *            true  延时在第一次请求时连接websocket\n   * @param handler\n   * @param secure\n   */\n  function WebSocketConnection(address, options, handler, secure) {\n    _classCallCheck(this, WebSocketConnection);\n\n    var _this = _possibleConstructorReturn(this, (WebSocketConnection.__proto__ || Object.getPrototypeOf(WebSocketConnection)).call(this, address, options, handler, secure));\n\n    _this._protocol = 'ws';\n    _this._ws = null;\n\n    var deferred = options && options.deferred === true || false;\n\n    if (deferred === false) {\n      _this._connect();\n    }\n    return _this;\n  }\n\n  _createClass(WebSocketConnection, [{\n    key: 'getStatus',\n    value: function getStatus() {\n      return this._ws ? this._ws.readyState : _WebSocket2.default.CLOSED;\n    }\n  }, {\n    key: '_connect',\n    value: function _connect() {\n      var _this2 = this;\n\n      // 连接创建websocket\n      if (typeof _WebSocket2.default !== 'undefined') {\n        this._ws = new _WebSocket2.default(this.getAddress());\n\n        // 避免WebSocket上没有状态静态值\n        if (_WebSocket2.default.OPEN === undefined) {\n          _WebSocket2.default.CONNECTING = this._ws.CONNECTING;\n          _WebSocket2.default.OPEN = this._ws.OPEN;\n          _WebSocket2.default.CLOSING = this._ws.CLOSING;\n          _WebSocket2.default.CLOSED = this._ws.CLOSED;\n        }\n        this._ws.binaryType = this.options.binaryType || this.options.dataType || 'arraybuffer';\n\n        this._ws.addEventListener('open', function () {\n          _this2.trigger(_BaseConnection3.default.EVENT_OPEN);\n        });\n        this._ws.addEventListener('error', function (err) {\n          _this2.trigger(_BaseConnection3.default.EVENT_ERROR, err);\n        });\n        this._ws.addEventListener('close', function () {\n          _this2.trigger(_BaseConnection3.default.EVENT_CLOSE);\n        });\n        this._ws.addEventListener('message', function (message) {\n          _this2.trigger(_BaseConnection3.default.EVENT_MESSAGE, message.data);\n          _this2.trigger(_BaseConnection3.default.EVENT_RESPONSE, message.data);\n        });\n      } else {\n        throw Error('Don\\'t support WebSocket');\n      }\n    }\n  }, {\n    key: 'request',\n    value: function request(message) {\n      var _this3 = this;\n\n      var msg = message || '';\n      if (this.getStatus() === _WebSocket2.default.CLOSED) {\n        this._connect();\n      }\n\n      if (this.getStatus() !== _WebSocket2.default.OPEN) {\n        this._ws.addEventListener('open', function () {\n          _this3._ws.send(msg);\n          _this3.trigger(_BaseConnection3.default.EVENT_SEND, msg);\n          _this3.trigger(_BaseConnection3.default.EVENT_REQUEST, msg);\n        });\n      } else {\n        this._ws.send(msg);\n        this.trigger(_BaseConnection3.default.EVENT_SEND, msg);\n        this.trigger(_BaseConnection3.default.EVENT_REQUEST, msg);\n      }\n      return this;\n    }\n  }, {\n    key: 'close',\n    value: function close() {\n      if (this.getStatus() !== _WebSocket2.default.CLOSED) {\n        this._ws.close();\n        this._ws = null;\n      }\n      return this;\n    }\n  }]);\n\n  return WebSocketConnection;\n}(_BaseConnection3.default);\n\n_BaseConnection3.default.ws = function ws(url, options, handler) {\n  return new WebSocketConnection(url, options, handler, false);\n};\n\n_BaseConnection3.default.wss = function wss(url, options, handler) {\n  return new WebSocketConnection(url, options, handler, true);\n};\n\nmodule.exports = _BaseConnection3.default;\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-connection/lib/WebSocketConnection.js","'use strict';\n\nvar _xhr = require('xhr2');\n\nvar _xhr2 = _interopRequireDefault(_xhr);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// 判断环境，浏览器环境存在window对象\nif (typeof window !== 'undefined') {\n\n  // 不考虑IE6以下的ActiveX方式\n  if (window.XMLHttpRequest) {\n    module.exports = window.XMLHttpRequest;\n  } else {\n    console.warn('当前浏览器不支持XMLHttpRequest');\n  }\n} else if (typeof XMLHttpRequest !== 'undefined') {\n  // eslint-disable-next-line no-undef\n  module.exports = XMLHttpRequest;\n} else {\n\n  // nodejs中使用xhr2模块\n  module.exports = _xhr2.default.XMLHttpRequest || _xhr2.default;\n}\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-connection/lib/XMLHttpRequest.js","'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /* eslint-disable */\n\n\nvar _XMLHttpRequest = require('./XMLHttpRequest');\n\nvar _XMLHttpRequest2 = _interopRequireDefault(_XMLHttpRequest);\n\nvar _util = require('./util');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * 模拟jquery的ajax接口\n */\n\n/**\n * 得到ArrayBuffer类型的响应数据\n * @param xhr\n * @returns {ArrayBuffer}\n */\nfunction getArrayBufferResponse(xhr) {\n  if (typeof ArrayBuffer === 'undefined') {\n    throw new Error('不支持ArrayBuffer类型');\n  } else if (xhr.response instanceof ArrayBuffer) {\n    return xhr.response;\n  } else {\n\n    var text = xhr.responseText;\n    var length = text.length;\n    var buf = new ArrayBuffer(length);\n    var bufView = new Uint8Array(buf);\n    for (var i = 0; i < length; i += 1) {\n\n      // \"& 0xff\"，表示在每个字符的两个字节之中，只保留后一个字节，将前一个字节扔掉。原因是浏览器解读字符的时候，会把字符自动解读成Unicode的0xF700-0xF7ff区段。\n      // http://www.ruanyifeng.com/blog/2012/09/xmlhttprequest_level_2.html\n      // eslint-disable-next-line no-bitwise\n      bufView[i] = text.charCodeAt(i) & 0xff;\n    }\n    return buf;\n  }\n}\n\n/**\n * 得到Blob类型的响应数据\n * @param xhr\n */\nfunction getBlobResponse(xhr) {\n  if (typeof Blob === 'undefined') {\n    throw new Error('不支持Blob类型');\n  } else if (xhr.response instanceof Blob) {\n    return xhr.response;\n  } else {\n    var buf = getArrayBufferResponse(xhr);\n\n    // TODO 未知类型\n    return new Blob([buf]);\n  }\n}\n\n// 修改自https://github.com/ForbesLindesay/ajax\nvar jsonpID = 0,\n    nodejs = typeof window === 'undefined',\n    document = !nodejs && window.document,\n    key,\n    name,\n    rscript = /<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi,\n    scriptTypeRE = /^(?:text|application)\\/javascript/i,\n    xmlTypeRE = /^(?:text|application)\\/xml/i,\n    jsonType = 'application/json',\n    htmlType = 'text/html',\n    blankRE = /^\\s*$/;\n\nvar ajax = module.exports = function (options) {\n  var settings = Object.assign({}, options || {});\n  for (key in ajax.settings) {\n    if (settings[key] === undefined) settings[key] = ajax.settings[key];\n  }ajaxStart(settings);\n\n  if (!settings.crossDomain) {\n    settings.crossDomain = /^([\\w-]+:)?\\/\\/([^\\/]+)/.test(settings.url) && !nodejs && !!window.location && RegExp.$2 != window.location.host;\n  }\n\n  var dataType = settings.dataType,\n      hasPlaceholder = /=\\?/.test(settings.url);\n  if (dataType == 'jsonp' || hasPlaceholder) {\n    if (!hasPlaceholder) settings.url = appendQuery(settings.url, 'callback=?');\n    return ajax.JSONP(settings);\n  }\n\n  if (!settings.url) settings.url = !nodejs && !!window.location && window.location.toString();\n  serializeData(settings);\n\n  var mime = settings.accepts[dataType],\n      baseHeaders = {},\n      protocol = /^([\\w-]+:)\\/\\//.test(settings.url) ? RegExp.$1 : !nodejs && !!window.location && window.location.protocol,\n      xhr = ajax.settings.xhr(),\n      abortTimeout;\n\n  if (!settings.crossDomain) baseHeaders['X-Requested-With'] = 'XMLHttpRequest';else if (typeof XDomainRequest !== 'undefined') {\n    xhr = new XDomainRequest();\n    xhr.onload = function () {\n      xhr.readyState = 4;\n      xhr.status = 200;\n      xhr.onreadystatechange();\n    };\n    xhr.error = function () {\n      xhr.readyState = 4;\n      xhr.status = 400;\n      xhr.onreadystatechange();\n    };\n  }\n  if (mime) {\n    baseHeaders['Accept'] = mime;\n    if (mime.indexOf(',') > -1) mime = mime.split(',', 2)[0];\n    xhr.overrideMimeType && xhr.overrideMimeType(mime);\n  }\n  if (settings.contentType || settings.data && settings.type.toUpperCase() != 'GET') baseHeaders['Content-Type'] = settings.contentType || 'application/x-www-form-urlencoded';\n  settings.headers = Object.assign(baseHeaders, settings.headers || {});\n\n  xhr.onreadystatechange = function () {\n    if (xhr.readyState == 4) {\n      clearTimeout(abortTimeout);\n      var result,\n          error = false;\n      if (xhr.status >= 200 && xhr.status < 300 || xhr.status == 304 || xhr.status == 0 && protocol == 'file:') {\n        dataType = dataType || mimeToDataType(xhr.contentType || xhr.getResponseHeader && xhr.getResponseHeader('content-type'));\n\n        try {\n          if (dataType == 'script') (1, eval)(result);else if (dataType == 'xml') result = xhr.responseXML;else if (dataType == 'json') result = blankRE.test(xhr.responseText) ? null : JSON.parse(xhr.responseText);else if (dataType === 'arraybuffer') result = getArrayBufferResponse(xhr);else if (dataType === 'blob') result = getBlobResponse(xhr);else result = xhr.responseText;\n        } catch (e) {\n          error = e;\n        }\n\n        if (error) ajaxError(error, 'parsererror', xhr, settings);else ajaxSuccess(result, xhr, settings);\n      } else {\n        ajaxError(null, 'error', xhr, settings);\n      }\n    }\n  };\n\n  var async = 'async' in settings ? settings.async : true;\n  xhr.open(settings.type, settings.url, async);\n\n  if (dataType == 'arraybuffer' || dataType == 'blob') {\n\n    // 因为IE的问题，只能将设置responseType的操作放在xhr.open之后\n    // https://connect.microsoft.com/IE/feedback/details/795580/ie11-xmlhttprequest-incorrectly-throws-invalidstateerror-when-setting-responsetype\n    // 判断是否支持设置responseType\n    var supported = typeof xhr.responseType === 'string';\n\n    // 支持二进制请求直接设置responseType\n    if (supported) {\n\n      // 响应类型默认arraybuffer，可以设置为blob（响应回来使用response取得数据）\n      xhr.responseType = options.dataType;\n    } else {\n\n      // 不支持则尝试使用用户自定义的字符集方式（响应回来使用responseText取得数据）\n      xhr.overrideMimeType ? xhr.overrideMimeType(\"text/plain; charset=x-user-defined\") : xhr.setRequestHeader('Accept-Charset', 'x-user-defined');\n    }\n  }\n\n  for (name in settings.headers) {\n    xhr.setRequestHeader(name, settings.headers[name]);\n  }if (ajaxBeforeSend(xhr, settings) === false) {\n    xhr.abort();\n    return false;\n  }\n\n  if (settings.timeout > 0) abortTimeout = setTimeout(function () {\n    xhr.onreadystatechange = empty;\n    xhr.abort();\n    ajaxError(null, 'timeout', xhr, settings);\n  }, settings.timeout);\n\n  // avoid sending empty string (#319)\n  xhr.send(settings.data ? settings.data : null);\n  return xhr;\n};\n\n// trigger a custom event and return false if it was cancelled\nfunction triggerAndReturn(context, eventName, data) {\n  //todo: Fire off some events\n  //var event = $.Event(eventName)\n  //$(context).trigger(event, data)\n  return true; //!event.defaultPrevented\n}\n\n// trigger an Ajax \"global\" event\nfunction triggerGlobal(settings, context, eventName, data) {\n  if (settings.global) return triggerAndReturn(context || document, eventName, data);\n}\n\n// Number of active Ajax requests\najax.active = 0;\n\nfunction ajaxStart(settings) {\n  if (settings.global && ajax.active++ === 0) triggerGlobal(settings, null, 'ajaxStart');\n}\nfunction ajaxStop(settings) {\n  if (settings.global && ! --ajax.active) triggerGlobal(settings, null, 'ajaxStop');\n}\n\n// triggers an extra global event \"ajaxBeforeSend\" that's like \"ajaxSend\" but cancelable\nfunction ajaxBeforeSend(xhr, settings) {\n  var context = settings.context;\n  if (settings.beforeSend.call(context, xhr, settings) === false || triggerGlobal(settings, context, 'ajaxBeforeSend', [xhr, settings]) === false) return false;\n\n  triggerGlobal(settings, context, 'ajaxSend', [xhr, settings]);\n}\nfunction ajaxSuccess(data, xhr, settings) {\n  var context = settings.context,\n      status = 'success';\n  settings.success.call(context, data, status, xhr);\n  triggerGlobal(settings, context, 'ajaxSuccess', [xhr, settings, data]);\n  ajaxComplete(status, xhr, settings);\n}\n// type: \"timeout\", \"error\", \"abort\", \"parsererror\"\nfunction ajaxError(error, type, xhr, settings) {\n  var context = settings.context;\n  settings.error.call(context, xhr, type, error);\n  triggerGlobal(settings, context, 'ajaxError', [xhr, settings, error]);\n  ajaxComplete(type, xhr, settings);\n}\n// status: \"success\", \"notmodified\", \"error\", \"timeout\", \"abort\", \"parsererror\"\nfunction ajaxComplete(status, xhr, settings) {\n  var context = settings.context;\n  settings.complete.call(context, xhr, status);\n  triggerGlobal(settings, context, 'ajaxComplete', [xhr, settings]);\n  ajaxStop(settings);\n}\n\n// Empty function, used as default callback\nfunction empty() {}\n\najax.JSONP = function (options) {\n  if (!('type' in options)) return ajax(options);\n\n  var callbackName = 'jsonp' + ++jsonpID,\n      script = document.createElement('script'),\n      abort = function abort() {\n    //todo: remove script\n    //$(script).remove()\n    if (!nodejs && callbackName in window) window[callbackName] = empty;\n    ajaxComplete('abort', xhr, options);\n  },\n      xhr = { abort: abort },\n      abortTimeout,\n      head = document.getElementsByTagName(\"head\")[0] || document.documentElement;\n\n  if (options.error) script.onerror = function () {\n    xhr.abort();\n    options.error();\n  };\n\n  if (!nodejs) window[callbackName] = function (data) {\n    clearTimeout(abortTimeout);\n    //todo: remove script\n    //$(script).remove()\n    delete window[callbackName];\n    ajaxSuccess(data, xhr, options);\n  };\n\n  serializeData(options);\n  script.src = options.url.replace(/=\\?/, '=' + callbackName);\n\n  // Use insertBefore instead of appendChild to circumvent an IE6 bug.\n  // This arises when a base node is used (see jQuery bugs #2709 and #4378).\n  head.insertBefore(script, head.firstChild);\n\n  if (options.timeout > 0) abortTimeout = setTimeout(function () {\n    xhr.abort();\n    ajaxComplete('timeout', xhr, options);\n  }, options.timeout);\n\n  return xhr;\n};\n\najax.settings = {\n  // Default type of request\n  type: 'GET',\n  // Callback that is executed before request\n  beforeSend: empty,\n  // Callback that is executed if the request succeeds\n  success: empty,\n  // Callback that is executed the the server drops error\n  error: empty,\n  // Callback that is executed on request complete (both: error and success)\n  complete: empty,\n  // The context for the callbacks\n  context: null,\n  // Whether to trigger \"global\" Ajax events\n  global: true,\n  // Transport\n  xhr: function xhr() {\n    return new _XMLHttpRequest2.default();\n  },\n  // MIME types mapping\n  accepts: {\n    script: 'text/javascript, application/javascript',\n    json: jsonType,\n    xml: 'application/xml, text/xml',\n    html: htmlType,\n    text: 'text/plain'\n  },\n  // Whether the request is to another domain\n  crossDomain: false,\n  // Default timeout\n  timeout: 0\n};\n\nfunction mimeToDataType(mime) {\n  return mime && (mime == htmlType ? 'html' : mime == jsonType ? 'json' : scriptTypeRE.test(mime) ? 'script' : xmlTypeRE.test(mime) && 'xml') || 'text';\n}\n\nfunction appendQuery(url, query) {\n  return (url + '&' + query).replace(/[&?]{1,2}/, '?');\n}\n\n// serialize payload and append it to the URL for GET requests\nfunction serializeData(options) {\n  if (_typeof(options.data) === 'object') options.data = (0, _util.param)(options.data);\n  if (options.data && (!options.type || options.type.toUpperCase() == 'GET')) options.url = appendQuery(options.url, options.data);\n}\n\najax.get = function (url, success) {\n  return ajax({ url: url, success: success });\n};\n\najax.post = function (url, data, success, dataType) {\n  if (typeof data === 'function') dataType = dataType || success, success = data, data = null;\n  return ajax({ type: 'POST', url: url, data: data, success: success, dataType: dataType });\n};\n\najax.getJSON = function (url, success) {\n  return ajax({ url: url, success: success, dataType: 'json' });\n};\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-connection/lib/ajax.js","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.serialize = serialize;\nexports.param = param;\nfunction serialize(params, obj, traditional, scope) {\n  var array = obj instanceof Array;\n  Object.keys(obj).forEach(function (key) {\n    var value = obj[key];\n\n    // eslint-disable-next-line no-param-reassign\n    if (scope) key = traditional ? scope : 'scope[' + (array ? '' : key) + ']'; // scope + '[' + (array ? '' : key) + ']'\n    // handle data in serializeArray() format\n    if (!scope && array) params.add(value.name, value.value);\n    // recurse into nested objects\n    else if (traditional ? value instanceof Array : (typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object') serialize(params, value, traditional, key);else params.add(key, value);\n  });\n}\n\nfunction param(obj, traditional) {\n  var params = [];\n  params.add = function add(k, v) {\n    this.push(encodeURIComponent(k) + '=' + encodeURIComponent(v));\n  };\n  serialize(params, obj, traditional);\n  return params.join('&').replace('%20', '+');\n}\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-connection/lib/util.js","export function serialize(params, obj, traditional, scope) {\n  const array = (obj instanceof Array);\n  Object.keys(obj).forEach((key) => {\n    const value = obj[key];\n\n    // eslint-disable-next-line no-param-reassign\n    if (scope) key = traditional ? scope : `scope[${(array ? '' : key)}]`; // scope + '[' + (array ? '' : key) + ']'\n    // handle data in serializeArray() format\n    if (!scope && array) params.add(value.name, value.value);\n    // recurse into nested objects\n    else if (traditional ? (value instanceof Array) : (typeof value === 'object')) serialize(params, value, traditional, key);\n    else params.add(key, value);\n  });\n}\n\nexport function param(obj, traditional) {\n  const params = [];\n  params.add = function add(k, v) { this.push(`${encodeURIComponent(k)}=${encodeURIComponent(v)}`); };\n  serialize(params, obj, traditional);\n  return params.join('&').replace('%20', '+');\n}\n\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-connection/src/util.js","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = parseJSON;\n\nvar _util = require('./util');\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction convertToJsonArray(input) {\n  if (!input || !input.head) return input;\n\n  var head = input.head;\n  var data = input.data;\n\n  return data.map(function (row) {\n    var rowObject = {};\n    row.forEach(function (cell, columnIndex) {\n      rowObject[head[columnIndex]] = convertToJsonArray(cell);\n    });\n    return rowObject;\n  });\n}\n\nfunction parseJSON(input) {\n  return Promise.resolve().then(function () {\n    var json = input instanceof ArrayBuffer ? (0, _util.arrayBufferToString)(input) : input;\n    var response = JSON.parse(json);\n    if (response.Err !== 0) {\n      return response;\n    }\n\n    var data = response.Data;\n    if (data.JsonTbl) {\n      var tbl = convertToJsonArray(data.JsonTbl);\n      var key = Object.keys(tbl[0])[0];\n      var value = tbl[0][key];\n      data = _defineProperty({\n        Id: data.Id\n      }, key, value);\n    }\n\n    return {\n      Qid: response.Qid,\n      Err: response.Err,\n      Counter: response.Counter,\n      Data: data\n    };\n  });\n}\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-dataparser/lib/parseJSON.js","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = uncompress;\n\nvar _snappy_decompressor = require('snappyjs/snappy_decompressor');\n\nfunction uncompress(compressed) {\n  if (!(compressed instanceof ArrayBuffer)) {\n    throw new TypeError('Argument compressed must be type of ArrayBuffer');\n  }\n\n  var decompressor = new _snappy_decompressor.SnappyDecompressor(new Uint8Array(compressed));\n  var length = decompressor.readUncompressedLength();\n  if (length === -1) {\n    throw new Error('Invalid Snappy bitstream');\n  }\n  var uncompressed = new ArrayBuffer(length);\n  var uncompressedView = new Uint8Array(uncompressed);\n  if (!decompressor.uncompressToBuffer(uncompressedView)) {\n    throw new Error('Invalid Snappy bitstream');\n  }\n  return uncompressed;\n}\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-dataparser/lib/snappyjs-uncompress.js","// empty (null-loader)\n\n\n// WEBPACK FOOTER //\n// ../dzhyun-dataparser/lib/parseProtoBuf.js","/* eslint-disable no-underscore-dangle */\n\nimport DzhyunDataParser from 'dzhyun-dataparser';\nimport DzhyunConnection from 'dzhyun-connection';\n\nimport { param, unParam } from './util';\n\nfunction formatParams(params) {\n  const result = {};\n  if (params) {\n    Object.keys(params).forEach((key) => {\n      let value = params[key];\n      if (value instanceof Array) {\n        value = value.join(',');\n      }\n      if (value != null) {\n        result[key] = value;\n      }\n    });\n  }\n  return param(result);\n}\n\nlet lastQid = 0;\nfunction getQid() {\n  return lastQid += 1; // eslint-disable-line\n}\n\n// 简易的事件监听接口实现\nclass EventEmiter {\n  _listenerMap = {};\n\n  /**\n   * 事件监听接口\n   */\n  on(type, listener) {\n    if (typeof listener === 'function') {\n      const listeners = this._listenerMap[type] || (this._listenerMap[type] = []);\n      if (listeners.indexOf(listener) < 0) {\n        listeners.push(listener);\n      }\n    }\n    return this;\n  }\n\n  off(type, listener) {\n    if (typeof listener === 'function') {\n      const listeners = this._listenerMap[type] || (this._listenerMap[type] = []);\n      const index = listeners.indexOf(listener);\n      if (index >= 0) listeners.splice(index, 1);\n    } else {\n      this._listenerMap[type] = [];\n    }\n    return this;\n  }\n\n  trigger(type, ...args) {\n    const listeners = this._listenerMap[type];\n    if (listeners) listeners.forEach(listener => listener.apply(this, args));\n    return this;\n  }\n\n  alias(type) {\n    if (type) {\n      this[`on${type}`] = this.on.bind(this, type);\n      this[`off${type}`] = this.off.bind(this, type);\n      if (!this[type]) this[type] = this.trigger.bind(this, type);\n    }\n  }\n}\n\nclass Request extends EventEmiter {\n  constructor(options) {\n    super();\n    Object.assign(this, options);\n    this.subscribe = !!(options.queryObject && options.queryObject.sub === 1);\n\n    this.alias('message');\n    this.alias('error');\n\n    this.onmessage(options.callback);\n    this.onerror(options.callback);\n  }\n\n  then(...args) {\n    return new Promise((resolve, reject) => {\n      this.onmessage(resolve);\n      this.onerror(reject);\n    }).then(...args);\n  }\n\n  catch(...args) {\n    return new Promise((resolve, reject) => {\n      this.onmessage(resolve);\n      this.onerror(reject);\n    }).catch(...args);\n  }\n}\n\nclass Dzhyun extends EventEmiter {\n  constructor({\n                address = 'ws://gw.yundzh.com/ws',\n                dataType = 'json',\n                compresser,\n                dataParser,\n                token,\n                generateQid,\n              } = {}) {\n    super();\n    this.address = address;\n    this.dataType = dataType;\n    this.compresser = compresser;\n    this.dataParser = dataParser || new DzhyunDataParser({ compresser });\n    this.token = token;\n    this.generateQid = generateQid || getQid;\n\n    this._requests = {};\n\n    this.alias('open');\n    this.alias('close');\n    this.alias('request');\n    this.alias('response');\n    this.alias('error');\n  }\n\n  _connection() {\n    this._conn = this._conn || Promise.resolve().then(() => {\n      const tokenPromise = this.token && this.token.getToken ? this.token.getToken() : this.token;\n      return Promise.resolve(tokenPromise)\n        .catch(err => console.warn('request token fail', err))\n        .then((token) => {\n          const connection = new DzhyunConnection(this.address, { deferred: true }, {\n            open: () => {\n              this.trigger('open');\n            },\n            request: (message) => {\n              this.trigger('request', message);\n            },\n            response: (data) => {\n              this.trigger('response', data);\n\n              // 解析数据\n              if (this.dataParser) {\n                Promise.resolve(this.dataParser.parse || this.dataParser).then((parse) => {\n                  parse.call(this.dataParser, data).then(({ Qid, Err, Counter, Data = {} }) => {\n                    if (!Qid) console.warn('Qid does not exist.');\n                    else {\n                      const request = this._requests[Qid];\n                      if (request) {\n                        if (Err !== 0) {\n                          // 服务端返回错误信息\n                          const { desc, code } = Data;\n                          const error = new Error(desc || 'unknown error');\n                          error.desc = desc;\n                          error.code = code;\n                          request.error(error, Counter, code, desc);\n                        } else {\n                          let resultData = Data;\n                          // 简化数据结构\n                          if (request.shrinkData) {\n                            // 返回数据中RepData开头的字段数据\n                            resultData = resultData[\n                              Object.keys(resultData)\n                                .filter(key => ['Id', 'Obj'].indexOf(key) < 0)\n                                .sort(key1 => (key1.indexOf('RepData') === 0 ? -1 : 1))[0]\n                              ];\n                          }\n                          request.message(resultData, Counter);\n                        }\n                        if (!request.subscribe) {\n                          delete this._requests[Qid];\n                        }\n                      }\n                    }\n                  }).catch((err) => {\n                    // 解析数据失败\n                    console.error(err);\n                  });\n                });\n              }\n            },\n            close: () => {\n              this.trigger('close');\n              // TODO 连接中断考虑重连\n            },\n            error: (err) => {\n              this.trigger('error', err);\n              // TODO 请求失败考虑请求\n            },\n          });\n          const connectionType = connection._protocol;\n          if (token) {\n            if (connectionType === 'ws' && connection._address.indexOf('token=') < 0) {\n              connection._address = `${connection._address}?token=${token}`;\n            }\n          }\n          this._conn = connection;\n          this._token = token;\n          this._connectionType = connectionType;\n          return this._conn;\n        });\n    });\n    return Promise.resolve(this._conn);\n  }\n\n  /**\n   * 查询方法\n   * @param {!string} url 查询的url\n   * @param {Object=} params 参数\n   * @param {function=} callback 回调函数\n   * @param {boolean=} shrinkData 返回的数据是否简化结构，默认值是true\n   */\n  query(url, params, callback, shrinkData) {\n    if (typeof url !== 'string') throw new Error('url must be a string');\n    if (typeof params !== 'object') {\n      shrinkData = callback; // eslint-disable-line\n      callback = params; // eslint-disable-line\n      params = null; // eslint-disable-line\n    }\n    if (typeof callback !== 'function') {\n      shrinkData = callback; // eslint-disable-line\n      callback = null; // eslint-disable-line\n    }\n    shrinkData = shrinkData !== false; // eslint-disable-line\n\n    const [serviceUrl, searchStr] = url.split('?');\n    const queryObject = Object.assign({\n      compresser: this.compresser || undefined,\n      output: this.dataType,\n    }, unParam(searchStr || ''), params);\n\n    let qid = queryObject.qid;\n    if (!qid) {\n      qid = this.generateQid(serviceUrl, queryObject);\n      queryObject.qid = qid;\n    }\n\n    const request = new Request({ qid, serviceUrl, queryObject, callback, shrinkData });\n    this._requests[qid] = request;\n    request.cancel = this.cancel.bind(this, qid);\n    this._connection().then((conn) => {\n      // 请求已经取消则直接返回\n      if (!this._requests[request.qid]) return;\n      let options;\n      if (this._connectionType === 'http') {\n        queryObject.token = queryObject.token || this._token;\n        // 如果以http协议请求pb格式数据时，需设置额外参数以指定响应数据是二进制数据\n        options = { dataType: 'arraybuffer' };\n      }\n      const requestParams = formatParams(queryObject);\n      conn.request(requestParams ? `${serviceUrl}?${requestParams}` : serviceUrl, options);\n    });\n    return request;\n  }\n\n  subscribe(url, params, callback, shrinkData) {\n    if (typeof params !== 'object') {\n      shrinkData = callback; // eslint-disable-line\n      callback = params; // eslint-disable-line\n      params = {}; // eslint-disable-line\n    }\n    params = params || {};  // eslint-disable-line\n    params.sub = 1;  // eslint-disable-line\n    return this.query(url, params, callback, shrinkData);\n  }\n\n  _cancelRequest(qid) {\n    if (this._connectionType === 'ws' && this._conn && this._conn.getStatus() === 1) {\n      this._conn.request(`/cancel?qid=${qid}`);\n    }\n  }\n\n  /**\n   * 取消查询\n   * @param {string=} qid\n   */\n  cancel(qid) {\n    if (qid) {\n      this._cancelRequest(qid);\n      delete this._requests[qid];\n    } else {\n      const requests = this._requests;\n      Object.keys(requests).forEach((eachQid) => {\n        this._cancelRequest(eachQid);\n        delete requests[eachQid];\n      });\n    }\n  }\n\n  // 关闭连接\n  close() {\n    // 取消当前请求，\n    this.cancel();\n    if (this._conn) this._conn.close();\n    this._conn = null;\n  }\n}\nDzhyun.Connection = DzhyunConnection;\nDzhyun.DataParser = DzhyunDataParser;\n\nmodule.exports = Dzhyun;\n\n\n\n// WEBPACK FOOTER //\n// ./src/Dzhyun.js","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// ws (ignored)\n// module id = 17\n// module chunks = 0 1","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// xhr2 (ignored)\n// module id = 18\n// module chunks = 0 1"],"sourceRoot":""}